name: Nightly Build Artifacts
on:
  [push, pull_request]
  #schedule:
  #  - cron: '0 0 * * *' # Eventuall will run at 2 AM UTC, for testimng 

jobs:
  nightly:
    name: Deploy nightly
    runs-on: ubuntu-latest
    steps:

    #- name: Find matching workflow
    #  uses: SamhammerAG/last-successful-build-action@v2
    #  with:
    #      token: "${{ secrets.GITHUB_TOKEN }}"
    #      branch: "main"
    #      workflow: "Installer"

    - name: Download artifact
      id: download-artifact
      uses: dawidd6/action-download-artifact@v2
      with:
        github_token: ${{secrets.GITHUB_TOKEN}}
        workflow: installers.yml
        branch: main

    - name: List files in the folder
      run: |
          ls ${{ github.workspace }}

          
    - name: Upload installer to GitHub releases
      uses: ncipollo/release-action@v1
      with:
        draft: true
        prerelease: true
        allowUpdates: true
        replacesArtifacts: true
        token: ${{ secrets.GITHUB_TOKEN }}
        artifacts: "SasView-Installer-macos*/SasView5.dmg, SasView-Installer-windows*/setupSasView.exe"
        name: "Nightly Build"
        tag: "nightly_build"
